æ¥¼ä¸»ä»Šå¤©åœ¨é¢ç»ä¸Šçœ‹åˆ°è¿™ä¸ªé¢˜ï¼ŒæŒºæœ‰æ„æ€ï¼Œå°å°çš„é¢˜ç›®å¯¹å¤šçº¿ç¨‹çš„è€ƒé‡è¿˜æŒºå¤šã€‚å¤§éƒ¨åˆ†åŒå­¦éƒ½ä¼šä½¿ç”¨ synchronized æ¥å®ç°ã€‚



æ¥¼ä¸»ä»Šå¤©å¸¦æ¥å¦å¤–ä¸¤ç§ä¼˜åŒ–å®ç°ï¼Œè®©ä½ é¢è¯•çš„æ—¶å€™ï¼Œå‚²è§†ç¾¤é›„ï¼





#### synchronizedå®ç°





```java
class ThreadPrintDemo2 {
  public static void main(String[] args) {
    final ThreadPrintDemo2 demo2 = new ThreadPrintDemo2();
    Thread t1 = new Thread(demo2::print1);
    Thread t2 = new Thread(demo2::print2);

    t1.start();
    t2.start();
  }

  public synchronized void print2() {
    for (int i = 1; i <= 100; i += 2) {
      System.out.println(i);
      this.notify();
      try {
        this.wait();
        Thread.sleep(100);
      } catch (InterruptedException e) {
        
      }
    }
  }

  public synchronized void print1() {
    for (int i = 0; i <= 100; i += 2) {
      System.out.println(i);
      this.notify();
      try {
        this.wait();
        Thread.sleep(100);
      } catch (InterruptedException e) {
        
      }
    }
  }
}
```

é€šè¿‡ synchronized åŒæ­¥ä¸¤ä¸ªæ–¹æ³•ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œæ¯æ‰“å°ä¸€ä¸ªæ•°ï¼Œå°±é‡Šæ”¾é”ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œæ‹¿åˆ°é”ï¼Œæ‰“å°ï¼Œå”¤é†’å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åæŒ‚èµ·è‡ªå·±ã€‚å¾ªç¯åå¤ï¼Œå®ç°äº†ä¸€ä¸ªæœ€åŸºæœ¬çš„æ‰“å°åŠŸèƒ½ã€‚é¢è¯•å¸¸é—®çš„ï¼š[Synchronized æœ‰å‡ ç§ç”¨æ³•](http://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247487913&idx=2&sn=318f4cbbde0669bd8c62af3501d2c915&chksm=eb53949fdc241d89be6b54cb3db4e7367a3ac4894c2911ac3fa236708dfb0360355660fb0ca4&scene=21#wechat_redirect)ã€‚

ä½†ï¼Œå¦‚æœä½ è¿™ä¹ˆå†™ï¼Œé¢è¯•å®˜è‚¯å®šæ˜¯ä¸æ»¡æ„çš„ã€‚æ¥¼ä¸»å°†ä»‹ç»ä¸€ç§æ›´å¥½çš„å®ç°ã€‚





#### CAS å®ç°

##  

```java
public class ThreadPrintDemo {

  static AtomicInteger cxsNum = new AtomicInteger(0);
  static volatile boolean flag = false;

  public static void main(String[] args) {

    Thread t1 = new Thread(() -> {
      for (; 100 > cxsNum.get(); ) {
        if (!flag && (cxsNum.get() == 0 || cxsNum.incrementAndGet() % 2 == 0)) {
          try {
            Thread.sleep(100);
          } catch (InterruptedException e) {
            
          }

          System.out.println(cxsNum.get());
          flag = true;
        }
      }
    }
    );

    Thread t2 = new Thread(() -> {
      for (; 100 > cxsNum.get(); ) {
        if (flag && (cxsNum.incrementAndGet() % 2 != 0)) {
          try {
            Thread.sleep(100);
          } catch (InterruptedException e) {
            
          }

          System.out.println(cxsNum.get());
          flag = false;
        }
      }
    }
    );

    t1.start();
    t2.start();
  }
}
```

æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ CASï¼Œé¿å…çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç„¶åå‘¢ï¼Œä½¿ç”¨ä¸€ä¸ª volatile çš„ boolean å˜é‡ï¼Œä¿è¯ä¸ä¼šå‡ºç°å¯è§æ€§é—®é¢˜ï¼Œè®°ä½ï¼Œè¿™ä¸ª flag ä¸€å®šè¦æ˜¯ volatile çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œå¯èƒ½ä½ çš„ç¨‹åºè¿è¡Œèµ·æ¥æ²¡é—®é¢˜ï¼Œä½†æœ€ç»ˆä¸€å®šä¼šå‡ºé—®é¢˜ï¼Œè€Œä¸”é¢è¯•å®˜ä¼šç«‹é©¬é„™è§†ä½ ã€‚é¢è¯•å¸¸é—®çš„ï¼š[æ·±å…¥ç†è§£CASç®—æ³•åŸç†](http://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247483728&idx=1&sn=3d734dc972a244891406cfbc443eabed&chksm=eb538466dc240d7033b889665b579a490266b8c8f1e7a08da35f67ca484dad19503e8b230e05&scene=21#wechat_redirect)ã€‚

è¿™æ ·å°±æ¶ˆé™¤äº†ä½¿ç”¨ synchronized å¯¼è‡´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¸¦æ¥çš„æŸè€—ï¼Œæ€§èƒ½æ›´å¥½ã€‚ç›¸ä¿¡ï¼Œå¦‚æœä½ é¢è¯•çš„æ—¶å€™ï¼Œè¿™ä¹ˆå†™ï¼Œé¢è¯•å®˜è‚¯å®šå¾ˆæ»¡æ„ã€‚

ä½†ï¼Œæˆ‘ä»¬è¿˜æœ‰æ€§èƒ½æ›´å¥½çš„ã€‚



#### volatileå®ç°



```java
class ThreadPrintDemo3{

  static volatile int num = 0;
  static volatile boolean flag = false;

  public static void main(String[] args) {

    Thread t1 = new Thread(() -> {
      for (; 100 > num; ) {
        if (!flag && (num == 0 || ++num % 2 == 0)) {

          try {
            Thread.sleep(100);
          } catch (InterruptedException e) {
            
          }

          System.out.println(num);
          flag = true;
        }
      }
    }
    );

    Thread t2 = new Thread(() -> {
      for (; 100 > num; ) {
        if (flag && (++num % 2 != 0)) {

          try {
            Thread.sleep(100);
          } catch (InterruptedException e) {
            
          }

          System.out.println(num);
          flag = false;
        }
      }
    }
    );

    t1.start();
    t2.start();

  }
}
```

æˆ‘ä»¬ä½¿ç”¨ [volatile](http://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247483916&idx=1&sn=89daf388da0d6fe40dc54e9a4018baeb&chksm=eb53873adc240e2cf55400f3261228d08fc943c4f196566e995681549c47630b70ac01b75031&scene=21#wechat_redirect) å˜é‡ä»£æ›¿ CAS å˜é‡ï¼Œå‡è½»ä½¿ç”¨ CAS çš„æ¶ˆè€—ï¼Œæ³¨æ„ï¼Œè¿™é‡Œ ++num ä¸æ˜¯åŸå­çš„ï¼Œä½†ä¸å¦¨ç¢ï¼Œå› ä¸ºæœ‰ flag å˜é‡æ§åˆ¶ã€‚è€Œ num å¿…é¡»æ˜¯ volatile çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œä¼šå¯¼è‡´å¯è§æ€§é—®é¢˜ã€‚

åˆ°è¿™é‡Œï¼Œå¦‚æœä½ é¢è¯•çš„æ—¶å€™è¿™ä¹ˆå†™ï¼Œé‚£ä¹ˆï¼Œoffer å°±ä¸è¿œå•¦ï¼å“ˆå“ˆğŸ˜†ï¼ï¼

## **å½©è›‹ï¼šå¦‚ä½•ç¿»è½¬å­—ç¬¦ä¸²ï¼Ÿ**



```java
class ReverseDemo {

  public static void main(String[] args) {

    String test = "abcdefg";

    System.out.println(new StringBuilder(test).reverse());

    char[] arr = test.toCharArray();

    for (int i = arr.length - 1; i >= 0; i--) {
      System.out.print(arr[i]);
    }

  }
}
```

``

è¿™ä¸ªå°±æ¯”è¾ƒç®€å•äº†ï¼Œä¸¤ç§æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯ StringBuilder çš„ reverse æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯è½¬æ¢æˆæ•°ç»„è‡ªå·±æ‰“å°ã€‚è‡ªå·±è½¬æ¢æ€§èƒ½æ›´å¥½ï¼Œreverse æ–¹æ³•å†…éƒ¨æ­¥éª¤æ›´å¤šã€‚